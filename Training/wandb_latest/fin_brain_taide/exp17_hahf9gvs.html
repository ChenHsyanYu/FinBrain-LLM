
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>exp17 (hahf9gvs)</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #ff6b6b;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
            border-bottom: 2px solid #4ecdc4;
            padding-bottom: 8px;
        }
        .info-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .info-item {
            margin: 8px 0;
            padding: 5px;
        }
        .info-label {
            font-weight: bold;
            color: #666;
            display: inline-block;
            min-width: 150px;
        }
        .chart-container {
            margin: 20px 0;
            padding: 10px;
            background-color: #fafafa;
            border-radius: 5px;
            min-height: 400px;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
            clear: both;
        }
        #charts {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        @media (max-width: 1200px) {
            #charts {
                grid-template-columns: 1fr;
            }
        }
        .summary-card {
            background-color: #fff;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .summary-card .key {
            font-weight: bold;
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .summary-card .value {
            font-size: 20px;
            color: #333;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>exp17</h1>
        <div class="info-section">
            <div class="info-item">
                <span class="info-label">Run ID:</span>
                <span>hahf9gvs</span>
            </div>
            <div class="info-item">
                <span class="info-label">State:</span>
                <span>killed</span>
            </div>
            <div class="info-item">
                <span class="info-label">Created:</span>
                <span>2025-10-07T13:23:41Z</span>
            </div>
        </div>

        <h2>Summary Metrics</h2>
        <div class="summary-grid" id="summary-grid"></div>

        <h2>Training History</h2>
        <div id="charts"></div>

        <h2>Configuration</h2>
        <pre>{
  "bf16": true,
  "fp16": false,
  "fsdp": [],
  "seed": 42,
  "tf32": null,
  "debug": [],
  "dtype": "bfloat16",
  "optim": "adamw_torch",
  "top_k": 50,
  "top_p": 1,
  "prefix": null,
  "do_eval": true,
  "no_cuda": false,
  "project": "huggingface",
  "use_cpu": false,
  "do_train": false,
  "head_dim": 128,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "mlp_bias": false,
  "run_name": "調整 lr ",
  "adafactor": false,
  "data_seed": null,
  "deepspeed": null,
  "do_sample": false,
  "hub_token": "<HUB_TOKEN>",
  "log_level": "passive",
  "max_steps": -1,
  "num_beams": 1,
  "ray_scope": "last",
  "report_to": [
    "wandb"
  ],
  "typical_p": 1,
  "use_cache": false,
  "adam_beta1": 0.9,
  "adam_beta2": 0.95,
  "do_predict": false,
  "eval_delay": 0,
  "eval_steps": null,
  "hidden_act": "silu",
  "is_decoder": false,
  "local_rank": 0,
  "max_length": 20,
  "min_length": 0,
  "model_type": "llama",
  "optim_args": null,
  "output_dir": "./models/exp19",
  "past_index": -1,
  "rope_theta": 500000,
  "save_steps": 500,
  "vocab_size": 188256,
  "ddp_backend": null,
  "ddp_timeout": 1800,
  "fsdp_config": {
    "xla": false,
    "xla_fsdp_v2": false,
    "min_num_params": 0,
    "xla_fsdp_grad_ckpt": false
  },
  "hidden_size": 4096,
  "label_names": null,
  "logging_dir": "./logs/exp19",
  "push_to_hub": false,
  "return_dict": true,
  "temperature": 1,
  "torchdynamo": null,
  "torchscript": false,
  "adam_epsilon": 1e-08,
  "bos_token_id": 128000,
  "disable_tqdm": true,
  "eos_token_id": 128001,
  "fp16_backend": "auto",
  "hub_model_id": null,
  "hub_revision": null,
  "hub_strategy": "every_save",
  "pad_token_id": null,
  "problem_type": null,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 8,
    "rope_type": "llama3",
    "low_freq_factor": 1,
    "high_freq_factor": 4,
    "original_max_position_embeddings": 8192
  },
  "sep_token_id": null,
  "use_bfloat16": false,
  "warmup_ratio": 0,
  "warmup_steps": 0,
  "weight_decay": 0.05,
  "_name_or_path": "taide/Llama-3.1-TAIDE-LX-8B-Chat",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bad_words_ids": null,
  "eval_on_start": false,
  "eval_strategy": "epoch",
  "jit_mode_eval": false,
  "learning_rate": 1.1e-05,
  "logging_steps": 500,
  "max_grad_norm": 1,
  "mp_parameters": "",
  "output_scores": false,
  "save_strategy": "epoch",
  "torch_compile": false,
  "tpu_num_cores": null,
  "attention_bias": false,
  "bf16_full_eval": false,
  "early_stopping": false,
  "fp16_full_eval": false,
  "fp16_opt_level": "O1",
  "length_penalty": 1,
  "pretraining_tp": 1,
  "tf_legacy_loss": false,
  "use_mps_device": false,
  "finetuning_task": null,
  "group_by_length": false,
  "hub_always_push": false,
  "num_beam_groups": 1,
  "save_only_model": false,
  "suppress_tokens": null,
  "tokenizer_class": null,
  "full_determinism": false,
  "hub_private_repo": null,
  "ignore_data_skip": false,
  "log_on_each_node": true,
  "logging_strategy": "epoch",
  "num_train_epochs": 20,
  "save_safetensors": true,
  "save_total_limit": null,
  "trackio_space_id": "trackio",
  "use_liger_kernel": false,
  "attention_dropout": 0,
  "ddp_bucket_cap_mb": null,
  "diversity_penalty": 0,
  "greater_is_better": false,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "log_level_replica": "warning",
  "lr_scheduler_type": "constant_with_warmup",
  "num_hidden_layers": 32,
  "output_attentions": false,
  "push_to_hub_token": "<PUSH_TO_HUB_TOKEN>",
  "save_on_each_node": false,
  "tpu_metrics_debug": false,
  "accelerator_config": {
    "even_batches": true,
    "non_blocking": false,
    "split_batches": false,
    "dispatch_batches": null,
    "use_seedable_sampler": true,
    "gradient_accumulation_kwargs": null
  },
  "batch_eval_metrics": false,
  "is_encoder_decoder": false,
  "length_column_name": "length",
  "logging_first_step": false,
  "parallelism_config": null,
  "repetition_penalty": 1,
  "torch_compile_mode": null,
  "add_cross_attention": false,
  "forced_bos_token_id": null,
  "forced_eos_token_id": null,
  "fsdp_min_num_params": 0,
  "include_for_metrics": [],
  "liger_kernel_config": null,
  "lr_scheduler_kwargs": {
    "min_lr": 3e-05
  },
  "neftune_noise_alpha": null,
  "num_attention_heads": 32,
  "num_key_value_heads": 8,
  "skip_memory_metrics": true,
  "tie_encoder_decoder": false,
  "tie_word_embeddings": false,
  "auto_find_batch_size": false,
  "dataloader_drop_last": false,
  "model/num_parameters": 8521781248,
  "no_repeat_ngram_size": 0,
  "num_return_sequences": 1,
  "optim_target_modules": null,
  "output_hidden_states": false,
  "overwrite_output_dir": false,
  "prediction_loss_only": false,
  "push_to_hub_model_id": null,
  "task_specific_params": null,
  "transformers_version": "4.57.0",
  "begin_suppress_tokens": null,
  "dataloader_pin_memory": true,
  "ddp_broadcast_buffers": null,
  "metric_for_best_model": "eval_loss",
  "remove_invalid_values": false,
  "remove_unused_columns": false,
  "torch_compile_backend": null,
  "dataloader_num_workers": 0,
  "decoder_start_token_id": null,
  "eval_do_concat_batches": true,
  "eval_use_gather_object": false,
  "gradient_checkpointing": false,
  "half_precision_backend": "auto",
  "label_smoothing_factor": 0,
  "load_best_model_at_end": true,
  "logging_nan_inf_filter": true,
  "resume_from_checkpoint": null,
  "chunk_size_feed_forward": 0,
  "eval_accumulation_steps": null,
  "max_position_embeddings": 131072,
  "per_gpu_eval_batch_size": null,
  "return_dict_in_generate": false,
  "torch_empty_cache_steps": null,
  "per_gpu_train_batch_size": null,
  "push_to_hub_organization": null,
  "include_tokens_per_second": false,
  "dataloader_prefetch_factor": null,
  "ddp_find_unused_parameters": null,
  "include_inputs_for_metrics": false,
  "per_device_eval_batch_size": 8,
  "use_legacy_prediction_loop": false,
  "cross_attention_hidden_size": null,
  "gradient_accumulation_steps": 16,
  "per_device_train_batch_size": 16,
  "encoder_no_repeat_ngram_size": 0,
  "average_tokens_across_devices": true,
  "dataloader_persistent_workers": false,
  "gradient_checkpointing_kwargs": null,
  "include_num_input_tokens_seen": "no",
  "exponential_decay_length_penalty": null,
  "fsdp_transformer_layer_cls_to_wrap": null,
  "restore_callback_states_from_checkpoint": false
}</pre>
    </div>

    <script>
        // 數據
        const historyData = [{"train/epoch": 1, "train/learning_rate": 5.9631755191873506e-05, "_step": 0, "_timestamp": 1759844955.2203681, "eval/runtime": null, "train/grad_norm": 0.10107421875, "train/global_step": 52, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 1533.060833732, "train/loss": 1.2816}, {"train/epoch": 1, "train/learning_rate": null, "_step": 1, "_timestamp": 1759845104.993226, "eval/runtime": 149.7704, "train/grad_norm": null, "train/global_step": 52, "eval/steps_per_second": 1.229, "eval/loss": 0.57877117395401, "eval/samples_per_second": 9.822, "_runtime": 1682.83372232, "train/loss": null}, {"train/epoch": 2, "train/learning_rate": 5.67457912825752e-05, "_step": 2, "_timestamp": 1759846674.0146265, "eval/runtime": null, "train/grad_norm": 0.1298828125, "train/global_step": 104, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 3251.855047621, "train/loss": 0.5602}, {"train/epoch": 2, "train/learning_rate": null, "_step": 3, "_timestamp": 1759846823.8127983, "eval/runtime": 149.7956, "train/grad_norm": null, "train/global_step": 104, "eval/steps_per_second": 1.228, "eval/loss": 0.5347995758056641, "eval/samples_per_second": 9.82, "_runtime": 3401.653289242, "train/loss": null}, {"train/epoch": 3, "train/learning_rate": 5.128660243389501e-05, "_step": 4, "_timestamp": 1759848392.5059283, "eval/runtime": null, "train/grad_norm": 0.11328125, "train/global_step": 156, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 4970.346437729, "train/loss": 0.5215}, {"train/epoch": 3, "train/learning_rate": null, "_step": 5, "_timestamp": 1759848542.3373733, "eval/runtime": 149.8289, "train/grad_norm": null, "train/global_step": 156, "eval/steps_per_second": 1.228, "eval/loss": 0.514723539352417, "eval/samples_per_second": 9.818, "_runtime": 5120.17796907, "train/loss": null}, {"train/epoch": 4, "train/learning_rate": 4.384577646563018e-05, "_step": 6, "_timestamp": 1759850115.0320504, "eval/runtime": null, "train/grad_norm": 0.1298828125, "train/global_step": 208, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 6692.87230762, "train/loss": 0.4979}, {"train/epoch": 4, "train/learning_rate": null, "_step": 7, "_timestamp": 1759850264.7754424, "eval/runtime": 149.7414, "train/grad_norm": null, "train/global_step": 208, "eval/steps_per_second": 1.229, "eval/loss": 0.5035432577133179, "eval/samples_per_second": 9.824, "_runtime": 6842.615952453, "train/loss": null}, {"train/epoch": 5, "train/learning_rate": 3.5229642327752976e-05, "_step": 8, "_timestamp": 1759851844.3399043, "eval/runtime": null, "train/grad_norm": 0.1005859375, "train/global_step": 260, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 8422.1802831, "train/loss": 0.4819}, {"train/epoch": 5, "train/learning_rate": null, "_step": 9, "_timestamp": 1759851993.88099, "eval/runtime": 149.5386, "train/grad_norm": null, "train/global_step": 260, "eval/steps_per_second": 1.23, "eval/loss": 0.4969559609889984, "eval/samples_per_second": 9.837, "_runtime": 8571.721390231, "train/loss": null}, {"train/epoch": 6, "train/learning_rate": 2.6371891847198426e-05, "_step": 10, "_timestamp": 1759853565.1577415, "eval/runtime": null, "train/grad_norm": 0.1162109375, "train/global_step": 312, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 10142.998307395, "train/loss": 0.4719}, {"train/epoch": 6, "train/learning_rate": null, "_step": 11, "_timestamp": 1759853714.9929175, "eval/runtime": 149.8325, "train/grad_norm": null, "train/global_step": 312, "eval/steps_per_second": 1.228, "eval/loss": 0.49346596002578735, "eval/samples_per_second": 9.818, "_runtime": 10292.833379988, "train/loss": null}, {"train/epoch": 7, "train/learning_rate": 1.8232399730694482e-05, "_step": 12, "_timestamp": 1759855287.4348028, "eval/runtime": null, "train/grad_norm": 0.09814453125, "train/global_step": 364, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 11865.275137874, "train/loss": 0.4649}, {"train/epoch": 7, "train/learning_rate": null, "_step": 13, "_timestamp": 1759855437.2014205, "eval/runtime": 149.7641, "train/grad_norm": null, "train/global_step": 364, "eval/steps_per_second": 1.229, "eval/loss": 0.49151915311813354, "eval/samples_per_second": 9.822, "_runtime": 12015.041874844, "train/loss": null}, {"train/epoch": 8, "train/learning_rate": 1.1693206246297377e-05, "_step": 14, "_timestamp": 1759857010.7685943, "eval/runtime": null, "train/grad_norm": 0.1015625, "train/global_step": 416, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 13588.608979354, "train/loss": 0.4617}, {"train/epoch": 8, "train/learning_rate": null, "_step": 15, "_timestamp": 1759857160.5463192, "eval/runtime": 149.7752, "train/grad_norm": null, "train/global_step": 416, "eval/steps_per_second": 1.229, "eval/loss": 0.4907890558242798, "eval/samples_per_second": 9.821, "_runtime": 13738.386917168, "train/loss": null}, {"train/epoch": 9, "train/learning_rate": 7.462934474082866e-06, "_step": 16, "_timestamp": 1759858732.4605982, "eval/runtime": null, "train/grad_norm": 0.10302734375, "train/global_step": 468, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 15310.301044304, "train/loss": 0.4603}, {"train/epoch": 9, "train/learning_rate": null, "_step": 17, "_timestamp": 1759858882.323909, "eval/runtime": 149.8607, "train/grad_norm": null, "train/global_step": 468, "eval/steps_per_second": 1.228, "eval/loss": 0.4904344975948334, "eval/samples_per_second": 9.816, "_runtime": 15460.164572104, "train/loss": null}, {"train/epoch": 10, "train/learning_rate": 6e-06, "_step": 18, "_timestamp": 1759860453.3219354, "eval/runtime": null, "train/grad_norm": 0.10302734375, "train/global_step": 520, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 17031.162249881, "train/loss": 0.4593}, {"train/epoch": 10, "train/learning_rate": null, "_step": 19, "_timestamp": 1759860603.1374576, "eval/runtime": 149.8131, "train/grad_norm": null, "train/global_step": 520, "eval/steps_per_second": 1.228, "eval/loss": 0.4902806282043457, "eval/samples_per_second": 9.819, "_runtime": 17180.977868795, "train/loss": null}, {"train/epoch": 10, "train/learning_rate": null, "_step": 20, "_timestamp": 1759860657.6379194, "eval/runtime": null, "train/grad_norm": null, "train/global_step": 520, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 17235.477621424, "train/loss": null}, {"train/epoch": 11, "train/learning_rate": 2.7527613071511125e-05, "_step": 21, "_timestamp": 1759889811.7424316, "eval/runtime": null, "train/grad_norm": 0.1083984375, "train/global_step": 572, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 18805.637331018, "train/loss": 0.4588}, {"train/epoch": 11, "train/learning_rate": null, "_step": 22, "_timestamp": 1759889961.8865361, "eval/runtime": 150.1416, "train/grad_norm": null, "train/global_step": 572, "eval/steps_per_second": 1.226, "eval/loss": 0.4880070388317108, "eval/samples_per_second": 9.797, "_runtime": 18955.781397003, "train/loss": null}, {"train/epoch": 12, "train/learning_rate": 2.26500078921671e-05, "_step": 23, "_timestamp": 1759891540.8541093, "eval/runtime": null, "train/grad_norm": 0.11376953125, "train/global_step": 624, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 20534.74886467, "train/loss": 0.4534}, {"train/epoch": 12, "train/learning_rate": null, "_step": 24, "_timestamp": 1759891691.6211095, "eval/runtime": 150.7646, "train/grad_norm": null, "train/global_step": 624, "eval/steps_per_second": 1.22, "eval/loss": 0.4865358769893646, "eval/samples_per_second": 9.757, "_runtime": 20685.516015964, "train/loss": null}, {"train/epoch": 13, "train/learning_rate": 1.7972083937801595e-05, "_step": 25, "_timestamp": 1759893268.0201495, "eval/runtime": null, "train/grad_norm": 0.119140625, "train/global_step": 676, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 22261.914814133, "train/loss": 0.45}, {"train/epoch": 13, "train/learning_rate": null, "_step": 26, "_timestamp": 1759893418.0563385, "eval/runtime": 150.0339, "train/grad_norm": null, "train/global_step": 676, "eval/steps_per_second": 1.226, "eval/loss": 0.4853988587856293, "eval/samples_per_second": 9.804, "_runtime": 22411.951266516, "train/loss": null}, {"train/epoch": 14, "train/learning_rate": 1.3620928907538629e-05, "_step": 27, "_timestamp": 1759894997.432448, "eval/runtime": null, "train/grad_norm": 0.1064453125, "train/global_step": 728, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 23991.327007461, "train/loss": 0.4472}, {"train/epoch": 14, "train/learning_rate": null, "_step": 28, "_timestamp": 1759895147.6905036, "eval/runtime": 150.2559, "train/grad_norm": null, "train/global_step": 728, "eval/steps_per_second": 1.225, "eval/loss": 0.4847841262817383, "eval/samples_per_second": 9.79, "_runtime": 24141.586236242, "train/loss": null}, {"train/epoch": 15, "train/learning_rate": 9.714752991779425e-06, "_step": 29, "_timestamp": 1759896727.495965, "eval/runtime": null, "train/grad_norm": 0.1064453125, "train/global_step": 780, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 25721.390794684, "train/loss": 0.4458}, {"train/epoch": 15, "train/learning_rate": null, "_step": 30, "_timestamp": 1759896877.972126, "eval/runtime": 150.4737, "train/grad_norm": null, "train/global_step": 780, "eval/steps_per_second": 1.223, "eval/loss": 0.48444807529449463, "eval/samples_per_second": 9.776, "_runtime": 25871.867058631, "train/loss": null}, {"train/epoch": 16, "train/learning_rate": 6.359677391798343e-06, "_step": 31, "_timestamp": 1759898454.546918, "eval/runtime": null, "train/grad_norm": 0.09619140625, "train/global_step": 832, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 27448.441754251, "train/loss": 0.4447}, {"train/epoch": 16, "train/learning_rate": null, "_step": 32, "_timestamp": 1759898605.1638114, "eval/runtime": 150.6146, "train/grad_norm": null, "train/global_step": 832, "eval/steps_per_second": 1.222, "eval/loss": 0.48432886600494385, "eval/samples_per_second": 9.767, "_runtime": 27599.058794968, "train/loss": null}, {"train/epoch": 17, "train/learning_rate": 3.6468512674680777e-06, "_step": 33, "_timestamp": 1759900184.9069445, "eval/runtime": null, "train/grad_norm": 0.10498046875, "train/global_step": 884, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 29178.801824721, "train/loss": 0.4446}, {"train/epoch": 17, "train/learning_rate": null, "_step": 34, "_timestamp": 1759900335.9687178, "eval/runtime": 151.0592, "train/grad_norm": null, "train/global_step": 884, "eval/steps_per_second": 1.218, "eval/loss": 0.4842711091041565, "eval/samples_per_second": 9.738, "_runtime": 29329.863886354, "train/loss": null}, {"train/epoch": 18, "train/learning_rate": 1.6499754385599463e-06, "_step": 35, "_timestamp": 1759901912.9318945, "eval/runtime": null, "train/grad_norm": 0.10400390625, "train/global_step": 936, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 30906.826630519, "train/loss": 0.4443}, {"train/epoch": 18, "train/learning_rate": null, "_step": 36, "_timestamp": 1759902063.570594, "eval/runtime": 150.6364, "train/grad_norm": null, "train/global_step": 936, "eval/steps_per_second": 1.221, "eval/loss": 0.4842557907104492, "eval/samples_per_second": 9.765, "_runtime": 31057.465660851, "train/loss": null}, {"train/epoch": 19, "train/learning_rate": 4.233001145702853e-07, "_step": 37, "_timestamp": 1759903639.6971388, "eval/runtime": null, "train/grad_norm": 0.10009765625, "train/global_step": 988, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 32633.591986386, "train/loss": 0.4443}, {"train/epoch": 19, "train/learning_rate": null, "_step": 38, "_timestamp": 1759903790.3733437, "eval/runtime": 150.6737, "train/grad_norm": null, "train/global_step": 988, "eval/steps_per_second": 1.221, "eval/loss": 0.484252005815506, "eval/samples_per_second": 9.763, "_runtime": 32784.268387352, "train/loss": null}, {"train/epoch": 20, "train/learning_rate": 1.5104983346780898e-10, "_step": 39, "_timestamp": 1759905367.4117372, "eval/runtime": null, "train/grad_norm": 0.0966796875, "train/global_step": 1040, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 34361.306514356, "train/loss": 0.4441}, {"train/epoch": 20, "train/learning_rate": null, "_step": 40, "_timestamp": 1759905518.1634176, "eval/runtime": 150.7493, "train/grad_norm": null, "train/global_step": 1040, "eval/steps_per_second": 1.221, "eval/loss": 0.4842515289783478, "eval/samples_per_second": 9.758, "_runtime": 34512.058572478, "train/loss": null}, {"train/epoch": 20, "train/learning_rate": null, "_step": 41, "_timestamp": 1759905571.1377091, "eval/runtime": null, "train/grad_norm": null, "train/global_step": 1040, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 34565.03183957, "train/loss": null}, {"train/epoch": 21, "train/learning_rate": 6e-05, "_step": 42, "_timestamp": 1759913377.7140021, "eval/runtime": null, "train/grad_norm": 0.134765625, "train/global_step": 1092, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 36229.32094866, "train/loss": 0.4492}, {"train/epoch": 21, "train/learning_rate": null, "_step": 43, "_timestamp": 1759913527.9043021, "eval/runtime": 150.1877, "train/grad_norm": null, "train/global_step": 1092, "eval/steps_per_second": 1.225, "eval/loss": 0.48144984245300293, "eval/samples_per_second": 9.794, "_runtime": 36379.511040561, "train/loss": null}, {"train/epoch": 22, "train/learning_rate": 6e-05, "_step": 44, "_timestamp": 1759915105.3496916, "eval/runtime": null, "train/grad_norm": 0.1533203125, "train/global_step": 1144, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 37956.956533023, "train/loss": 0.4355}, {"train/epoch": 22, "train/learning_rate": null, "_step": 45, "_timestamp": 1759915255.572998, "eval/runtime": 150.2208, "train/grad_norm": null, "train/global_step": 1144, "eval/steps_per_second": 1.225, "eval/loss": 0.4774128496646881, "eval/samples_per_second": 9.792, "_runtime": 38107.180048934, "train/loss": null}, {"train/epoch": 23, "train/learning_rate": 6e-05, "_step": 46, "_timestamp": 1759916831.0494025, "eval/runtime": null, "train/grad_norm": 0.15625, "train/global_step": 1196, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 39682.656191105, "train/loss": 0.4235}, {"train/epoch": 23, "train/learning_rate": null, "_step": 47, "_timestamp": 1759916982.1417325, "eval/runtime": 151.0899, "train/grad_norm": null, "train/global_step": 1196, "eval/steps_per_second": 1.218, "eval/loss": 0.47435733675956726, "eval/samples_per_second": 9.736, "_runtime": 39833.748831383, "train/loss": null}, {"train/epoch": 24, "train/learning_rate": 6e-05, "_step": 48, "_timestamp": 1759918557.3931668, "eval/runtime": null, "train/grad_norm": 0.1484375, "train/global_step": 1248, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 41408.999995297, "train/loss": 0.4116}, {"train/epoch": 24, "train/learning_rate": null, "_step": 49, "_timestamp": 1759918707.6337001, "eval/runtime": 150.2381, "train/grad_norm": null, "train/global_step": 1248, "eval/steps_per_second": 1.225, "eval/loss": 0.4717349410057068, "eval/samples_per_second": 9.791, "_runtime": 41559.240631626, "train/loss": null}, {"train/epoch": 25, "train/learning_rate": 6e-05, "_step": 50, "_timestamp": 1759920284.6976843, "eval/runtime": null, "train/grad_norm": 0.138671875, "train/global_step": 1300, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 43136.304563131, "train/loss": 0.4006}, {"train/epoch": 25, "train/learning_rate": null, "_step": 51, "_timestamp": 1759920434.5846894, "eval/runtime": 149.8844, "train/grad_norm": null, "train/global_step": 1300, "eval/steps_per_second": 1.228, "eval/loss": 0.4698846936225891, "eval/samples_per_second": 9.814, "_runtime": 43286.191710854, "train/loss": null}, {"train/epoch": 26, "train/learning_rate": 6e-05, "_step": 52, "_timestamp": 1759922020.8800585, "eval/runtime": null, "train/grad_norm": 0.1865234375, "train/global_step": 1352, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 44872.48685914, "train/loss": 0.3906}, {"train/epoch": 26, "train/learning_rate": null, "_step": 53, "_timestamp": 1759922172.4162235, "eval/runtime": 151.5338, "train/grad_norm": null, "train/global_step": 1352, "eval/steps_per_second": 1.214, "eval/loss": 0.46891462802886963, "eval/samples_per_second": 9.707, "_runtime": 45024.023331508, "train/loss": null}, {"train/epoch": 27, "train/learning_rate": 6e-05, "_step": 54, "_timestamp": 1759923754.7207367, "eval/runtime": null, "train/grad_norm": 0.146484375, "train/global_step": 1404, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 46606.327556515, "train/loss": 0.3803}, {"train/epoch": 27, "train/learning_rate": null, "_step": 55, "_timestamp": 1759923905.0864909, "eval/runtime": 150.3634, "train/grad_norm": null, "train/global_step": 1404, "eval/steps_per_second": 1.224, "eval/loss": 0.4672137200832367, "eval/samples_per_second": 9.783, "_runtime": 46756.693419671, "train/loss": null}, {"train/epoch": 28, "train/learning_rate": 6e-05, "_step": 56, "_timestamp": 1759925480.4459484, "eval/runtime": null, "train/grad_norm": 0.1572265625, "train/global_step": 1456, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 48332.052842692, "train/loss": 0.3713}, {"train/epoch": 28, "train/learning_rate": null, "_step": 57, "_timestamp": 1759925630.463786, "eval/runtime": 150.0154, "train/grad_norm": null, "train/global_step": 1456, "eval/steps_per_second": 1.227, "eval/loss": 0.46607863903045654, "eval/samples_per_second": 9.806, "_runtime": 48482.07071406, "train/loss": null}, {"train/epoch": 29, "train/learning_rate": 6e-05, "_step": 58, "_timestamp": 1759927239.9423313, "eval/runtime": null, "train/grad_norm": 0.212890625, "train/global_step": 1508, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 50091.549024509, "train/loss": 0.3625}, {"train/epoch": 29, "train/learning_rate": null, "_step": 59, "_timestamp": 1759927399.2164044, "eval/runtime": 159.2718, "train/grad_norm": null, "train/global_step": 1508, "eval/steps_per_second": 1.155, "eval/loss": 0.46539950370788574, "eval/samples_per_second": 9.236, "_runtime": 50250.82371292, "train/loss": null}, {"train/epoch": 30, "train/learning_rate": 6e-05, "_step": 60, "_timestamp": 1759929074.1392932, "eval/runtime": null, "train/grad_norm": 0.162109375, "train/global_step": 1560, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 51925.746398362, "train/loss": 0.3536}, {"train/epoch": 30, "train/learning_rate": null, "_step": 61, "_timestamp": 1759929245.7505884, "eval/runtime": 171.6074, "train/grad_norm": null, "train/global_step": 1560, "eval/steps_per_second": 1.072, "eval/loss": 0.46540573239326477, "eval/samples_per_second": 8.572, "_runtime": 52097.357792933, "train/loss": null}, {"train/epoch": 30, "train/learning_rate": null, "_step": 62, "_timestamp": 1759929299.3024123, "eval/runtime": null, "train/grad_norm": null, "train/global_step": 1560, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 52150.944713836, "train/loss": null}, {"train/epoch": 31, "train/learning_rate": 1.2805136722921635e-05, "_step": 63, "_timestamp": 1760022194.4869854, "eval/runtime": null, "train/grad_norm": 0.134765625, "train/global_step": 1612, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 53844.294580562, "train/loss": 0.3412}, {"train/epoch": 31, "train/learning_rate": null, "_step": 64, "_timestamp": 1760022344.8898504, "eval/runtime": 150.4006, "train/grad_norm": null, "train/global_step": 1612, "eval/steps_per_second": 1.223, "eval/loss": 0.46475863456726074, "eval/samples_per_second": 9.781, "_runtime": 53994.697216587, "train/loss": null}, {"train/epoch": 32, "train/learning_rate": 1.1429858032994709e-05, "_step": 65, "_timestamp": 1760023923.4430335, "eval/runtime": null, "train/grad_norm": 0.126953125, "train/global_step": 1664, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 55573.250146234, "train/loss": 0.3394}, {"train/epoch": 32, "train/learning_rate": null, "_step": 66, "_timestamp": 1760024073.931668, "eval/runtime": 150.4866, "train/grad_norm": null, "train/global_step": 1664, "eval/steps_per_second": 1.223, "eval/loss": 0.4648280739784241, "eval/samples_per_second": 9.775, "_runtime": 55723.739091724, "train/loss": null}, {"train/epoch": 33, "train/learning_rate": 1.019419462876103e-05, "_step": 67, "_timestamp": 1760025653.5204358, "eval/runtime": null, "train/grad_norm": 0.126953125, "train/global_step": 1716, "eval/steps_per_second": null, "eval/loss": null, "eval/samples_per_second": null, "_runtime": 57303.327691888, "train/loss": 0.3386}, {"train/epoch": 33, "train/learning_rate": null, "_step": 68, "_timestamp": 1760025803.793549, "eval/runtime": 150.271, "train/grad_norm": null, "train/global_step": 1716, "eval/steps_per_second": 1.224, "eval/loss": 0.46488142013549805, "eval/samples_per_second": 9.789, "_runtime": 57453.600984457, "train/loss": null}];
        const summary = {"_runtime": 57981, "_step": 68, "_timestamp": 1760025803.793549, "_wandb": "{'runtime': 57981}", "eval/loss": 0.4648814201354981, "eval/runtime": 150.271, "eval/samples_per_second": 9.789, "eval/steps_per_second": 1.224, "total_flos": 37823777717920730000, "train/epoch": 33, "train/global_step": 1716, "train/grad_norm": 0.126953125, "train/learning_rate": 1.019419462876103e-05, "train/loss": 0.3386, "train_loss": 0.13262974665715144, "train_runtime": 17459.5194, "train_samples_per_second": 22.746, "train_steps_per_second": 0.089};

        // 渲染 Summary Cards
        const summaryGrid = document.getElementById('summary-grid');
        Object.entries(summary).forEach(([key, value]) => {
            if (typeof value === 'number' || typeof value === 'string') {
                const card = document.createElement('div');
                card.className = 'summary-card';
                card.innerHTML = `
                    <div class="key">${key}</div>
                    <div class="value">${typeof value === 'number' ? value.toFixed(4) : value}</div>
                `;
                summaryGrid.appendChild(card);
            }
        });

        // 獲取所有數值列
        const columns = historyData.length > 0 ? Object.keys(historyData[0]) : [];
        const numericColumns = columns.filter(col => {
            return historyData.some(row => typeof row[col] === 'number');
        }).filter(col => col !== '_step' && col !== '_runtime' && col !== '_timestamp');

        // 按指標類型分組
        const metricGroups = {};
        numericColumns.forEach(col => {
            // 提取基礎指標名稱（去掉 train_, eval_, test_ 等前綴）
            let baseMetric = col;
            let prefix = '';

            if (col.startsWith('train/')) {
                prefix = 'train';
                baseMetric = col.substring(6);
            } else if (col.startsWith('eval/')) {
                prefix = 'eval';
                baseMetric = col.substring(5);
            } else if (col.startsWith('test/')) {
                prefix = 'test';
                baseMetric = col.substring(5);
            } else if (col.startsWith('train_')) {
                prefix = 'train';
                baseMetric = col.substring(6);
            } else if (col.startsWith('eval_')) {
                prefix = 'eval';
                baseMetric = col.substring(5);
            } else if (col.startsWith('test_')) {
                prefix = 'test';
                baseMetric = col.substring(5);
            }

            if (!metricGroups[baseMetric]) {
                metricGroups[baseMetric] = [];
            }
            metricGroups[baseMetric].push({name: col, prefix: prefix});
        });

        // 為每個指標組創建圖表
        const chartsDiv = document.getElementById('charts');
        Object.entries(metricGroups).forEach(([baseMetric, metrics]) => {
            const chartDiv = document.createElement('div');
            chartDiv.className = 'chart-container';
            chartDiv.id = 'chart-' + baseMetric.replace(/[^a-zA-Z0-9]/g, '_');
            chartsDiv.appendChild(chartDiv);

            const traces = [];
            metrics.forEach(metric => {
                // 優先使用 epoch 作為 X 軸，如果沒有則使用 _step
                const x = historyData.map((row, idx) => {
                    if (row['train/epoch'] !== undefined && row['train/epoch'] !== null) return row['train/epoch'];
                    if (row['epoch'] !== undefined && row['epoch'] !== null) return row['epoch'];
                    if (row['_step'] !== undefined) return row['_step'];
                    return idx;
                });
                const y = historyData.map(row => row[metric.name]);

                const trace = {
                    x: x,
                    y: y,
                    mode: 'lines+markers',
                    name: metric.name,
                    line: {
                        width: 2
                    },
                    marker: {
                        size: 4
                    },
                    connectgaps: true
                };
                traces.push(trace);
            });

            // 決定 X 軸標籤
            const hasEpoch = historyData.some(row => row['train/epoch'] !== undefined || row['epoch'] !== undefined);
            const layout = {
                title: baseMetric,
                xaxis: {
                    title: hasEpoch ? 'Epoch' : 'Step',
                    gridcolor: '#e0e0e0'
                },
                yaxis: {
                    title: 'Value',
                    gridcolor: '#e0e0e0'
                },
                plot_bgcolor: '#ffffff',
                paper_bgcolor: '#fafafa',
                margin: {
                    l: 60,
                    r: 30,
                    t: 50,
                    b: 50
                },
                showlegend: true,
                legend: {
                    x: 1.05,
                    y: 1
                }
            };

            Plotly.newPlot('chart-' + baseMetric.replace(/[^a-zA-Z0-9]/g, '_'), traces, layout, {responsive: true});
        });

        // 如果沒有分組的指標，單獨顯示
        if (Object.keys(metricGroups).length === 0 && numericColumns.length > 0) {
            const hasEpoch = historyData.some(row => row['train/epoch'] !== undefined || row['epoch'] !== undefined);

            numericColumns.forEach(col => {
                // 優先使用 epoch 作為 X 軸，如果沒有則使用 _step
                const x = historyData.map((row, idx) => {
                    if (row['train/epoch'] !== undefined && row['train/epoch'] !== null) return row['train/epoch'];
                    if (row['epoch'] !== undefined && row['epoch'] !== null) return row['epoch'];
                    if (row['_step'] !== undefined) return row['_step'];
                    return idx;
                });
                const y = historyData.map(row => row[col]);

                const chartDiv = document.createElement('div');
                chartDiv.className = 'chart-container';
                chartDiv.id = 'chart-' + col;
                chartsDiv.appendChild(chartDiv);

                const trace = {
                    x: x,
                    y: y,
                    mode: 'lines+markers',
                    name: col,
                    line: {
                        width: 2
                    },
                    marker: {
                        size: 4
                    },
                    connectgaps: true
                };

                const layout = {
                    title: col,
                    xaxis: {
                        title: hasEpoch ? 'Epoch' : 'Step',
                        gridcolor: '#e0e0e0'
                    },
                    yaxis: {
                        title: 'Value',
                        gridcolor: '#e0e0e0'
                    },
                    plot_bgcolor: '#ffffff',
                    paper_bgcolor: '#fafafa',
                    margin: {
                        l: 60,
                        r: 30,
                        t: 50,
                        b: 50
                    }
                };

                Plotly.newPlot('chart-' + col, [trace], layout, {responsive: true});
            });
        }
    </script>
</body>
</html>
